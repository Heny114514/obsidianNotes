$$\newcommand{\lcm}{\text{lcm}}$$
# 数论与密码学

## 群论初步

### Group 群

元素集合$G$与二元运算$\huge\cdot$构成群$\{G,\cdot\}$，如果满足：
- **封闭性**：若$a\in G$且$b\in G$，则$a\cdot b\in G$
- **结合律**：$a\cdot b\cdot c=a\cdot(b\cdot c)$
- **单位元**：存在单位元$e\in G$，使得$G$中任意元素满足$a\cdot e=e\cdot a=a$
- **逆元**：对$G$中任意元素$a$，存在$a'\in G$，满足$a\cdot a'=a'\cdot a=e$

>在群的基础定义中，不需要满足交换律

一个群$G$被称为**交换群**（**阿贝尔群**），如果满足：
- **交换律**：$a\cdot b=b\cdot a$

对群$G$中的指数运算定义如下：
- $a^0=e$
- $a^n=a^{n-1}\cdot a$
- $a^{-n}=(a^{-1})^n$，其中$a^{-1}$为$a$的逆元

一个群$G$被称为**循环群**，如果满足：
- 存在**生成元**$g$，使得$G$中任何元素都能表示为$g^k(k\in\mathbb{Z})$

>无论是有限群还是无限群，循环群总是**交换群**

### Rings 环

元素集合$R$与两个二元运算加法（$+$）和乘法（$\times$）构成环$\{R,+,\times\}$，如果满足：
- $\{R,+\}$是一个**交换群**，单位元为$0$，$a$的逆元为$-a$
- **乘法封闭性**：若$a\in R$且$b\in R$，则$a\times b\in R$
- **乘法结合律**：$a\times b\times c=a\times (b\times c)$
- **乘法分配律**：$a\times(b+c)=a\times b+a\times c,(a+b)\times c=a\times c+b\times c$

>在环的基础定义中，不需要满足**乘法交换律**、不要求存在**乘法单位元**、不要求存在**乘法逆元**，但需要满足**加法交换律**
>$a\times b$可简写为$ab$

一个环$R$被称为**交换环**，如果满足：
- **乘法交换律**：$a\times b=b\times a$

一个环$R$被称为**整环**，如果满足：
- $R$是一个**交换环**
- **乘法单位元**：存在元素$1\in R$，使得$R$中任意元素都满足$1\times a=a\times 1=a$
- **无零因子**：若$ab=0$，则$a=0$或$b=0$

### Fields 域

一个环$\{F,+,\times\}$被称为域，如果满足：
- $F$是一个**整环**
- **乘法逆元**：对$F$中任意元素$a$，存在$a^{-1}\in F$，满足$a\times a^{-1}=a^{-1}\times a=1$

对域$F$中的除法定义如下：
- $a/b=a(b^{-1})$

>由此，一个域F对加、减、乘、除运算封闭

## 素数

### 良序原理
**公理** 非空的自然数集的子集存在最小元
### 算数基本定理
**定理** 每一个大于$1$的整数都可以唯一的表示为素数的积
$$\huge a=\prod_{i=1}^{\infty}p_i^{\alpha_i}$$

### 最大公约数
**定义** 能够同时整除不全为零的$a$和$b$的最大整数$d$，记作$\gcd(a,b)$
>$\gcd(-24,-36)=12,\gcd(-17,22)=1$

### 最小公倍数
**定义** 能够同时被正整数$a$和$b$整除的最小正整数，记作$\lcm(a,b)$
**定理** 若$a,b$为正整数，则$\gcd(a,b)\cdot \lcm(a,b)=ab$

### 贝祖定理

**定理** 若$a,b$是正整数，则存在整数$s,t$使得
$$\huge \gcd(a,b)=sa+tb$$
>该定理可推广至$a,b$为任意整数且不全为零，则$\gcd(a,b)$是$a,b$的整系数线性组合中的最小正元

**推论** 若$d|a$且$d|b$，则$d|\gcd(a,b)$

**定义** 正整数$a,b$的贝祖系数为$s,t$，如果：$sa+tb=\gcd(a,b)$

### 素数测试

**定理** 若$a$是合数，则$a$必有小于或等于$\sqrt{a}$的因子

**推论** 若$a$是合数，则$a$必有小于或等于$\sqrt{a}$的素因子

#### 试除法
依次讲$\leq\sqrt{a}$的素数除$a$来判断$a$是否为素数
>时间复杂度：$O(2^{d/2})$，$d$为输入数据的二进制位数

#### 埃拉托斯特尼筛法
```cpp
#include<bits/stdc++.h>
using namespace std;
#define N 100
bool prime[N+1];
int main(){
	memset(prime,true,sizeof(prime));
	for(int i=2;i<=N;i++){
		if(!prime[i]) continue;
		for(int j=i+i;j<=N;j+=i) prime[j]=false;
	}
	for(int i=2;i<=N;i++) 
		if(prime[i]) cout<<i<<' ';
	return 0;
}
```

复杂度比较：在找出$\leq n$的所有素数的条件下
- 筛法复杂度：$O(2^d\log{d})$或$O(n\log{\log{n}})$
- 试除法复杂度：$O(2^d\cdot 2^{d/2})$或$O(n\cdot n^{1/2})$

### 无穷素数
**定理** 素数的个数是无限的

**定义** 梅森素数是形如$2^p-1$的素数，其中$p$为素数

### 素数定理
**定理** 记$\pi(x)$表示不超过$x$的素数个数，则有
$$\huge \lim_{n\rightarrow\infty}{\dfrac{\pi(x)\ln{x}}{x}}=1$$
## 互素
**定义** $a,b$互素如果$gcd(a,b)=1$
**定义** $a_1,a_2,...,a_n$两两互素如果$a_i,a_j$对任意$1\leq i<j\leq n$都互素

### 欧几里得算法
```cpp
int gcd(int a,int b){
	if(b==0) return a;
	return gcd(b,a%b);
}
```
### 扩展欧几里得算法 求贝祖系数
```cpp
void exgcd(int a,int b,int &d,int &x,int &y){
    if(b==0){
        d=a;
        x=1;
        y=0;
        return;
    }
    exgcd(b,a%b,d,y,x);
    y -= (a/b)*x;
}
```
满足$xa+yb=d=\gcd(a,b)$

>可用于求解模$m$下的逆：
>若$gcd(a,m)=1$，则有$xa+ym=1$，即
>$$\huge xa\equiv1\pmod{n}$$

### 同余除法
**定理** 若$ac\equiv bc\pmod m$，则有
$$\huge a\equiv b\pmod{\dfrac{m}{\gcd(m,c)}}$$
**推论** 若$m,c$互素，则有
$$\huge a\equiv b\pmod m$$
## 同余方程
**定义** 若$aa^{-1}\equiv1\pmod m$，则称$a^{-1}$为$a$模$m$的逆
**定理** 若$a,m$互素且$m>1$，则$a$在模$m$下有唯一逆元

### 中国剩余定理

**定理** 设$m_1,m_2,...,m_n$两两互素且均大于一，$a_1,a_2,...,a_n$是任意整数，则方程组
$$\huge\begin{cases}
x\equiv a_1\pmod{m_1}\\
x\equiv a_2\pmod{m_2}\\
\cdots\\
x\equiv a_n\pmod{m_n}

\end{cases}$$
在模$m=m_1m_2...m_n$的意义下有唯一解
$$\huge x\equiv a_1M_1M_1^{-1}+a_2M_2M_2^{-1}+\cdots+a_nM_nM_n^{-1}\pmod m$$
其中，$M_i=\frac{m}{m_i}$，$M_i^{-1}$是$M_i$在模$m_i$下的逆

### 回代法
**例** 求解同余方程$$\huge \begin{cases}
x\equiv2\pmod3\cdots\cdots(1)\\
x\equiv3\pmod5\cdots\cdots(2)\\
x\equiv2\pmod7\cdots\cdots(3)
\end{cases}$$
**解**
由$(1)$得
$$\huge x=3r+2$$
代入$(2)$得
$$\huge 3r+2\equiv3\pmod5$$
解得
$$\huge r\equiv2\pmod5$$
此即
$$\huge r=5s+2$$
回代得
$$\huge x=15s+8$$
代入$(3)$得
$$\huge 15s+8\equiv2\pmod7$$
解得
$$\huge s\equiv1\pmod7$$
此即
$$\huge s=7t+1$$
回代得
$$\huge x=105t+23$$
即
$$\huge x\equiv{23}\pmod{105}$$
## 威尔逊定理
**定理** $p$是素数当且仅当$(p-1)!\equiv{-1}\pmod p$

## 欧拉函数与欧拉定理